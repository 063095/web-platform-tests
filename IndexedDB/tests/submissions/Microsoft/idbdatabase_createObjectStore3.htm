<!DOCTYPE html>
<html>
<head>
    <title id='desc'>IDBDatabase.createObjectStore() - attempt to create an object store outside of a version change transaction </title>
    <script type="text/javascript" src="support.js"></script>
    <script src="http://w3c-test.org/resources/testharness.js"></script>
    <script src="http://w3c-test.org/resources/testharnessreport.js"></script>
    <script type="text/javascript">
        var objectStoreName = "objectstore";
        var keypath = "IETestCenterKeyPath";
        var db = null;

        var t = async_test(document.title); 
        Initialize();
        function RunTest() 
        {
            try 
            {
                var rqOpen = window.indexedDB.open(databaseName);
                rqOpen.onsuccess = function (event) 
                {
                    try 
                    {
                        db = event.target.result;
                        db.onerror = FailTest;
                        db.createObjectStore(objectStoreName);
                        FailTest();
                    }
                    catch (ex) 
                    {
                        if (ex.code == IDBDatabaseException.NOT_ALLOWED_ERR) 
                        {
                            PassTest();
                        }
                        else 
                        {
                            FailTest();
                        }
                    }
                };
                rqOpen.onerror = FailTest;
            }
            catch (ex) 
            {
                FailTest();
            }
        }
            
    </script>
</head>
<body>
    <div id="log"></div>
</body>
</html>
